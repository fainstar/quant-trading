<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>📊 量化交易系統 | 智能股票分析平台</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="app-shell">
        <aside class="sidebar">
            <div class="brand-block">
                <div class="logo">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div class="brand-text">
                    <h1>量化交易系統</h1>
                    <span>Smart Quant Workflow</span>
                </div>
            </div>

            <div class="datetime-card">
                <div>
                    <label>今日日期</label>
                    <strong id="currentDate">--</strong>
                </div>
                <div>
                    <label>目前時間</label>
                    <strong id="currentTime">--</strong>
                </div>
            </div>

            <div class="stats-group">
                <div class="stat-tile">
                    <div class="stat-icon"><i class="fas fa-list"></i></div>
                    <div class="stat-content">
                        <span>股票總數</span>
                        <strong id="totalStocks">0</strong>
                    </div>
                </div>
                <div class="stat-tile">
                    <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
                    <div class="stat-content">
                        <span>成功執行</span>
                        <strong id="successCount">0</strong>
                    </div>
                </div>
                <div class="stat-tile">
                    <div class="stat-icon"><i class="fas fa-clock"></i></div>
                    <div class="stat-content">
                        <span>排程狀態</span>
                        <strong id="scheduleStatus">未啟用</strong>
                    </div>
                </div>
                <div class="stat-tile">
                    <div class="stat-icon"><i class="fas fa-history"></i></div>
                    <div class="stat-content">
                        <span>歷史記錄</span>
                        <strong id="historyCount">0</strong>
                    </div>
                </div>
            </div>
        </aside>

        <div class="content">
            <!-- 主標題區域 -->
            <div class="hero">
                <div>
                    <h2>歡迎使用量化交易系統</h2>
                    <p>智能化的股票分析與交易排程平台</p>
                </div>
            </div>

            <!-- 卡片網格 -->
            <div class="panel-grid">
                <!-- 股票清單管理 -->
                <div class="panel">
                    <div class="panel-header">
                        <h3>
                            <span><i class="fas fa-list-ul"></i></span>
                            股票清單管理
                        </h3>
                    </div>
                    <div class="panel-description">
                        管理您的股票清單，設定分析參數，並透過 Discord 獲取即時報告。
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label><i class="fas fa-calendar-alt"></i> 抓取年數</label>
                            <input type="number" id="years" class="form-control" value="10" min="1" max="20">
                        </div>

                        <div class="form-group">
                            <label><i class="fas fa-paper-plane"></i> Discord Webhook URL</label>
                            <input type="url" id="webhookUrl" class="form-control" placeholder="https://discord.com/api/webhooks/..." autocomplete="off">
                        </div>
                    </div>

                    <div class="stock-list" id="stockList">
                        <!-- 動態生成 -->
                    </div>

                    <div class="add-stock-form">
                        <input type="text" id="newStock" class="form-control" placeholder="輸入股票代號 (例: 2330.TW)" onkeypress="if(event.key==='Enter') addStock()">
                        <button class="btn btn-primary" onclick="addStock()">
                            <i class="fas fa-plus"></i> 新增
                        </button>
                    </div>

                    <div class="btn-group">
                        <button class="btn btn-success" onclick="saveConfig()">
                            <i class="fas fa-save"></i> 儲存配置
                        </button>
                        <button class="btn btn-secondary" onclick="selectAll()">
                            <i class="fas fa-check-double"></i> 全選
                        </button>
                        <button class="btn btn-danger" onclick="deselectAll()">
                            <i class="fas fa-times"></i> 取消選擇
                        </button>
                    </div>
                    
                    <div class="btn-group" style="margin-top: 0.5rem;">
                        <button class="btn btn-secondary" onclick="selectTaiwan()">
                            <i class="fas fa-building"></i> 選擇台股
                        </button>
                        <button class="btn btn-secondary" onclick="selectUS()">
                            <i class="fas fa-chart-line"></i> 選擇美股
                        </button>
                        <button class="btn btn-secondary" onclick="selectCrypto()">
                            <i class="fas fa-coins"></i> 選擇虛擬貨幣
                        </button>
                    </div>
                </div>

                <!-- 快速執行 -->
                <div class="panel">
                    <div class="panel-header">
                        <h3>
                            <span><i class="fas fa-rocket"></i></span>
                            快速執行
                        </h3>
                    </div>
                    <div class="panel-description">
                        立即對選中的股票執行分析，並獲取即時結果與建議。
                    </div>

                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i>
                        <div>
                            <strong>自動化流程</strong><br>
                            📊 數據抓取 → 🔬 指標計算 → 🎯 訊號預測 → 📬 Discord 推送
                        </div>
                    </div>

                    <div class="toggle-wrapper" style="margin: 1rem 0;">
                        <span class="toggle-label">
                            <i class="fas fa-paper-plane"></i> 分析完成後推送 Discord 報告
                        </span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="sendReportToggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <button class="btn btn-primary btn-lg btn-block" onclick="executeAnalysis()">
                        <i class="fas fa-play"></i>
                        執行選中股票分析
                    </button>

                    <div id="executionStatus" class="execution-status"></div>

                    <div class="alert alert-success" id="discordStatusNote" style="margin-top: 1rem;">
                        <i class="fas fa-check-circle"></i>
                        <div>
                            <strong>Discord 自動推送</strong><br>
                            分析完成後自動發送報告到您的頻道
                        </div>
                    </div>
                </div>
            </div>

            <!-- 排程與歷史 -->
            <div class="panel-grid">
                <!-- 排程管理 -->
                <div class="panel">
                    <div class="panel-header">
                        <h3>
                            <span><i class="fas fa-calendar-check"></i></span>
                            排程管理
                        </h3>
                    </div>
                    <div class="panel-description">
                        設定自動排程，系統將依據排程自動執行分析並推送結果。
                    </div>

                    <div class="toggle-wrapper">
                        <span class="toggle-label">
                            <i class="fas fa-power-off"></i> 啟用自動排程
                        </span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="scheduleEnabled">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-clock"></i> 執行時間</label>
                        <input type="time" id="scheduleTime" class="form-control" value="20:00">
                    </div>

                    <div class="toggle-wrapper" style="margin-bottom: 1rem;">
                        <span class="toggle-label">
                            <i class="fas fa-paper-plane"></i> 排程完成後推送 Discord 報告
                        </span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="scheduleSendReport" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-tags"></i> 排程股票</label>
                        <div id="scheduleStocks" class="schedule-display">
                            將在儲存時自動使用目前選中的股票
                        </div>
                    </div>

                    <div class="btn-group">
                        <button class="btn btn-success" onclick="saveSchedule()">
                            <i class="fas fa-save"></i> 儲存排程
                        </button>
                        <button class="btn btn-secondary" onclick="loadSchedule()">
                            <i class="fas fa-sync"></i> 重新載入
                        </button>
                    </div>

                    <div class="alert alert-info" style="margin-top: 1rem;">
                        <i class="fas fa-robot"></i>
                        <div>
                            <strong>智能自動化</strong><br>
                            排程啟動後將每日定時執行並推送結果
                        </div>
                    </div>
                </div>

                <!-- 執行歷史 -->
                <div class="panel">
                    <div class="panel-header">
                        <h3>
                            <span><i class="fas fa-history"></i></span>
                            執行歷史
                        </h3>
                        <span style="margin-left: auto; font-size: 0.8rem; opacity: 0.9;">
                            <i class="fas fa-sync-alt"></i> 每10秒自動更新
                        </span>
                    </div>
                    <div class="panel-description">
                        檢視過去的執行記錄，了解分析結果與建議。
                    </div>

                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="loadHistory()">
                            <i class="fas fa-sync"></i> 立即刷新
                        </button>
                        <button class="btn btn-danger" onclick="clearHistory()">
                            <i class="fas fa-trash"></i> 清除歷史
                        </button>
                    </div>

                    <div class="history-list" id="historyList">
                        <!-- 動態生成 -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/js/app.js"></script>




</body>
</html>
